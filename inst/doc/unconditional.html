<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2019-01-30" />

<title>Spectral backtests of unconditional coverage</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Spectral backtests of unconditional coverage</h1>
<h4 class="date"><em>2019-01-30</em></h4>



<p>The basic spectral Z-test is called with the routine <code>monospectral_Ztest()</code>.</p>
<p>We two samples of PIT values. The first (PIT1) has uniform distribution, which coincides with the null hypothesis. The second (PIT2) has beta distribution with excess mass in the upper and lower tails.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">750</span>
alfbet &lt;-<span class="st"> </span><span class="fl">0.8</span>

PIT1 &lt;-<span class="st"> </span><span class="kw">runif</span>(n)
PIT2 &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,alfbet,alfbet)

<span class="kw">hist</span>(PIT2)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The spectral test is specified using a kernel list of type “mono” or “bi” or “multi”. We want to run a set of tests, so specify a list of kernel lists.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">alpha1 &lt;-<span class="st"> </span><span class="fl">0.95</span>
alpha_star &lt;-<span class="st"> </span><span class="fl">0.99</span>
alpha2 &lt;-<span class="st"> </span><span class="fl">0.995</span>

BIN &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="dt">name =</span> <span class="st">'Binomial score at 99%'</span>,
             <span class="dt">type =</span> <span class="st">'mono'</span>,
             <span class="dt">nu =</span> nu_discrete,
             <span class="dt">support =</span> alpha_star,
             <span class="dt">param =</span> <span class="dv">1</span> )

ZU3 &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="dt">name =</span> <span class="st">'Discrete Uniform 3'</span>,
             <span class="dt">type =</span> <span class="st">'mono'</span>,
             <span class="dt">nu =</span> nu_discrete,
             <span class="dt">support =</span> <span class="kw">c</span>(alpha1, alpha_star, alpha2),
             <span class="dt">param =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>) )

ZE &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="dt">name =</span> <span class="st">'Epanechnikov'</span>,
            <span class="dt">type =</span> <span class="st">'mono'</span>,
            <span class="dt">nu =</span> nu_epanechnikov,
            <span class="dt">support =</span> <span class="kw">c</span>(alpha1, alpha2),
            <span class="dt">param =</span> <span class="ot">NULL</span> )

ZU &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="dt">name =</span> <span class="st">'Uniform'</span>,
            <span class="dt">type =</span> <span class="st">'mono'</span>,
            <span class="dt">nu =</span> nu_uniform,
            <span class="dt">support =</span> <span class="kw">c</span>(alpha1, alpha2),
            <span class="dt">param =</span> <span class="ot">NULL</span> )

ZLp &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="dt">name =</span> <span class="st">'LinearUp'</span>,
            <span class="dt">type =</span> <span class="st">'mono'</span>,
            <span class="dt">nu =</span> nu_linear,
            <span class="dt">support =</span> <span class="kw">c</span>(alpha1, alpha2),
            <span class="dt">param =</span> <span class="dv">1</span> )
ZLn &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="dt">name =</span> <span class="st">'LinearDown'</span>,
            <span class="dt">type =</span> <span class="st">'mono'</span>,
            <span class="dt">nu =</span> nu_linear,
            <span class="dt">support =</span> <span class="kw">c</span>(alpha1, alpha2),
            <span class="dt">param =</span> <span class="op">-</span><span class="dv">1</span> )


ZLL &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="dt">name =</span> <span class="st">'linear/Linear'</span>,
             <span class="dt">type =</span> <span class="st">'bi'</span>,
             <span class="dt">nu =</span> <span class="kw">list</span>(nu_linear, nu_linear),
             <span class="dt">correlation =</span> rho_linear_linear,
             <span class="dt">support =</span> <span class="kw">c</span>(alpha1, alpha2),
             <span class="dt">param =</span> <span class="kw">list</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>) )

ZAE &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="dt">name =</span> <span class="st">'Arcsin/Epanechnikov'</span>,
             <span class="dt">type =</span> <span class="st">'bi'</span>,
             <span class="dt">nu =</span> <span class="kw">list</span>(nu_arcsin, nu_epanechnikov),
             <span class="dt">correlation =</span> rho_arcsin_epanechnikov,
             <span class="dt">support =</span> <span class="kw">c</span>(alpha1, alpha2),
             <span class="dt">param =</span> <span class="kw">list</span>(<span class="ot">NULL</span>, <span class="ot">NULL</span>) )

PNS &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="dt">name =</span> <span class="st">'Probitnormal score'</span>,
             <span class="dt">type =</span> <span class="st">'bi'</span>,
             <span class="dt">nu =</span> <span class="kw">list</span>(nu_probitnormal, nu_probitnormal),
             <span class="dt">correlation =</span> rho_probitnormal,
             <span class="dt">support =</span> <span class="kw">c</span>(alpha1, alpha2),
             <span class="dt">param =</span> <span class="kw">list</span>(<span class="dv">1</span>, <span class="dv">2</span>) )

Pearson3 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">name =</span> <span class="st">'Pearson'</span>,
                 <span class="dt">type =</span> <span class="st">'multi'</span>,
                 <span class="dt">nu =</span> nu_pearson,
                 <span class="dt">correlation =</span> rho_pearson,
                 <span class="dt">support=</span><span class="ot">NULL</span>,
                 <span class="dt">param=</span><span class="kw">list</span>(alpha1, alpha_star, alpha2))

<span class="co"># gather the tests into a list and execute!</span>
kernlist &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">BIN=</span>BIN, <span class="dt">Pearson3=</span>Pearson3, <span class="dt">ZU3=</span>ZU3,
                 <span class="dt">ZU=</span>ZU, <span class="dt">ZE=</span>ZE, <span class="dt">ZLp=</span>ZLp, <span class="dt">ZLn=</span>ZLn,
                 <span class="dt">ZLL=</span>ZLL, <span class="dt">ZAE=</span>ZAE, <span class="dt">PNS=</span>PNS)

pval &lt;-<span class="st"> </span><span class="kw">map_df</span>(<span class="kw">list</span>(PIT1, PIT2), 
               <span class="cf">function</span>(P) <span class="kw">lapply</span>(kernlist, <span class="cf">function</span>(kern) <span class="kw">spectral_Ztest</span>(kern,P))) <span class="op">%&gt;%</span>
<span class="st">        </span><span class="kw">mutate</span>(<span class="dt">PIT=</span><span class="kw">c</span>(<span class="st">'Uniform'</span>,<span class="kw">sprintf</span>(<span class="st">'Beta(%0.2f,%0.2f)'</span>,alfbet,alfbet))) <span class="op">%&gt;%</span>
<span class="st">        </span><span class="kw">select</span>(<span class="st">'PIT'</span>, <span class="kw">everything</span>())

<span class="kw">kable</span>(pval, <span class="dt">digits=</span><span class="dv">4</span>)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">PIT</th>
<th align="right">BIN</th>
<th align="right">Pearson3</th>
<th align="right">ZU3</th>
<th align="right">ZU</th>
<th align="right">ZE</th>
<th align="right">ZLp</th>
<th align="right">ZLn</th>
<th align="right">ZLL</th>
<th align="right">ZAE</th>
<th align="right">PNS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Uniform</td>
<td align="right">0.8544</td>
<td align="right">0.8957</td>
<td align="right">0.8857</td>
<td align="right">0.6929</td>
<td align="right">0.5646</td>
<td align="right">0.6095</td>
<td align="right">0.7642</td>
<td align="right">0.8043</td>
<td align="right">0.1751</td>
<td align="right">0.7258</td>
</tr>
<tr class="even">
<td align="left">Beta(0.80,0.80)</td>
<td align="right">0.0059</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
</tr>
</tbody>
</table>
<p>Now let’s see how to assess the size and power of the test. We generate a large number of backtesting samples, and apply the same set of tests to each. Results are gathered in a tibble. We summarize the tibble by reporting the percentage of rejections (at the 5% level) for each test.</p>
<p>To assess <em>size</em>, we need a uniform DGP, so set <span class="math inline">\(a=b=1\)</span>. Ideally, the test will reject about 5% of the time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">500</span>
a &lt;-<span class="st"> </span>b &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co"># if a==b==1, we are assessing size of test</span>
Npf &lt;-<span class="st"> </span><span class="dv">5000</span>  <span class="co"># number of portfolios</span>
rpval &lt;-<span class="st"> </span><span class="cf">function</span>(kernellist) {
  P &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,a,b)
  <span class="kw">map</span>(kernellist, <span class="op">~</span><span class="kw">spectral_Ztest</span>(.x,P))
}

df &lt;-<span class="st"> </span><span class="kw">rerun</span>(Npf, <span class="kw">rpval</span>(kernlist)) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">map_df</span>(<span class="st">`</span><span class="dt">[</span><span class="st">`</span>,<span class="kw">names</span>(kernlist))
rejectrate &lt;-<span class="st"> </span><span class="kw">summarize_all</span>(df, <span class="kw">list</span>(<span class="cf">function</span>(x) <span class="kw">mean</span>(x<span class="op">&lt;=</span><span class="fl">0.05</span>)))
<span class="kw">kable</span>(rejectrate, <span class="dt">digits=</span><span class="dv">4</span>, <span class="dt">caption=</span><span class="st">'Size. Frequency of test rejections at 5% level'</span>)</code></pre></div>
<table>
<caption>Size. Frequency of test rejections at 5% level</caption>
<thead>
<tr class="header">
<th align="right">BIN</th>
<th align="right">Pearson3</th>
<th align="right">ZU3</th>
<th align="right">ZU</th>
<th align="right">ZE</th>
<th align="right">ZLp</th>
<th align="right">ZLn</th>
<th align="right">ZLL</th>
<th align="right">ZAE</th>
<th align="right">PNS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.0406</td>
<td align="right">0.0518</td>
<td align="right">0.0476</td>
<td align="right">0.0476</td>
<td align="right">0.05</td>
<td align="right">0.0492</td>
<td align="right">0.0508</td>
<td align="right">0.0504</td>
<td align="right">0.0486</td>
<td align="right">0.0506</td>
</tr>
</tbody>
</table>
<p>Finally, we assess the <em>power</em> of the tests against a non-uniform DGP. Here we want the test to reject as often as possible.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span>b &lt;-<span class="st"> </span>alfbet  
df &lt;-<span class="st"> </span><span class="kw">rerun</span>(Npf, <span class="kw">rpval</span>(kernlist)) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">map_df</span>(<span class="st">`</span><span class="dt">[</span><span class="st">`</span>,<span class="kw">names</span>(kernlist))
rejectrate &lt;-<span class="st"> </span><span class="kw">summarize_all</span>(df, <span class="kw">list</span>(<span class="cf">function</span>(x) <span class="kw">mean</span>(x<span class="op">&lt;=</span><span class="fl">0.05</span>)))
<span class="kw">kable</span>(rejectrate, <span class="dt">digits=</span><span class="dv">4</span>, <span class="dt">caption=</span><span class="st">'Power. Frequency of test rejections at 5% level'</span>)</code></pre></div>
<table>
<caption>Power. Frequency of test rejections at 5% level</caption>
<thead>
<tr class="header">
<th align="right">BIN</th>
<th align="right">Pearson3</th>
<th align="right">ZU3</th>
<th align="right">ZU</th>
<th align="right">ZE</th>
<th align="right">ZLp</th>
<th align="right">ZLn</th>
<th align="right">ZLL</th>
<th align="right">ZAE</th>
<th align="right">PNS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.588</td>
<td align="right">0.715</td>
<td align="right">0.7806</td>
<td align="right">0.7734</td>
<td align="right">0.7568</td>
<td align="right">0.757</td>
<td align="right">0.7522</td>
<td align="right">0.7088</td>
<td align="right">0.7246</td>
<td align="right">0.7454</td>
</tr>
</tbody>
</table>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
